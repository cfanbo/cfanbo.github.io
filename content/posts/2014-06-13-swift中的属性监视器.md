---
title: Swift中的属性监视器
author: admin
type: post
date: 2014-06-13T03:31:37+00:00
url: /archives/15090
categories:
 - 程序开发
tags:
 - swift

---
属性监视器监控和响应属性值的变化，每次属性被设置值的时候都会调用属性监视器，甚至新的值和现在的值相同的时候也不例外。

可以为除了延迟存储属性之外的其他存储属性添加属性监视器，也可以通过重载属性的方式为继承的属性（包括存储属性和计算属性）添加属性监视器。属性重载请参考继承一章的重载。

注意：

不需要为无法重载的计算属性添加属性监视器，因为可以通过 setter 直接监控和响应值的变化。
可以为属性添加如下的一个或全部监视器：

willSet在设置新的值之前调用
didSet在新的值被设置之后立即调用
willSet监视器会将新的属性值作为固定参数传入，在willSet的实现代码中可以为这个参数指定一个名称，如果不指定则参数仍然可用，这时使用默认名称newValue表示。

类似地，didSet监视器会将旧的属性值作为参数传入，可以为该参数命名或者使用默认参数名oldValue。

注意：

willSet和didSet监视器在属性初始化过程中不会被调用，他们只会当属性的值在初始化之外的地方被设置时被调用。
这里是一个willSet和didSet的实际例子，其中定义了一个名为StepCounter的类，用来统计当人步行时的总步数，可以跟计步器或其他日常锻炼的统计装置的输入数据配合使用。

class StepCounter {
var totalSteps: Int = 0 {
willSet(newTotalSteps) {
println(“About to set totalSteps to \(newTotalSteps)”)
}
didSet {
if totalSteps > oldValue {
println(“Added \(totalSteps – oldValue) steps”)
}
}
}
}
let stepCounter = StepCounter()
stepCounter.totalSteps = 200
// About to set totalSteps to 200
// Added 200 steps
stepCounter.totalSteps = 360
// About to set totalSteps to 360
// Added 160 steps
stepCounter.totalSteps = 896
// About to set totalSteps to 896
// Added 536 steps
StepCounter类定义了一个Int类型的属性totalSteps，它是一个存储属性，包含willSet和didSet监视器。

当totalSteps设置新值的时候，它的willSet和didSet监视器都会被调用，甚至当新的值和现在的值完全相同也会调用。

例子中的willSet监视器将表示新值的参数自定义为newTotalSteps，这个监视器只是简单的将新的值输出。

didSet监视器在totalSteps的值改变后被调用，它把新的值和旧的值进行对比，如果总的步数增加了，就输出一个消息表示增加了多少步。didSet没有提供自定义名称，所以默认值oldValue表示旧值的参数名。

注意：

如果在didSet监视器里为属性赋值，这个值会替换监视器之前设置的值。

转自： [http://numbbbbb.github.io/the-swift-programming-language-in-chinese/chapter2/10_Properties.html](http://numbbbbb.github.io/the-swift-programming-language-in-chinese/chapter2/10_Properties.html)