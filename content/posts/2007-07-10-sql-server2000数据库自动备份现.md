---
title: Sql Server2000数据库自动备份现
author: admin
type: post
date: 2007-07-10T22:08:55+00:00
url: /archives/5
categories:
 - 数据库

---
第一种，最简单。
1、启动SQL服务器

2、打开企业管理器

3、进入你服务器下“管理”，启动“SQL Server代理”，如果这个启动不了的话什么都不能做。

4、进入“管理”下的“数据库维护计划”

5、右键，“新建维护计划”

6、下一步

7、选择你要备份的数据库，下一步

8、下一步

9、下一步

10、点“更改”，详细设定你要备份的周期

11、下一步，可以更改你备份文件的目录

12、一直点下一步直到完成

13、打开服务器属性，选择“自动启动SQL Server代理”，OK大功告成

第二种：

1.在要备份的数据上建立以下存储过程：
Create PROCEDURE [dbo].[过程名] AS
declare
@filename nvarchar(100),–文件名
@NowDay int –设置时间
set @filename='F:\JXXdata'+cast(Day(GetDate()) as varchar(2))+'.dat' –文件路径及文件名
Set @NowDay=Day(GetDate())
if (@NowDay>=20) or (@NowDay<=10) --这个月的20到下个月的10要备份 begin print @filename BACKUP DATABASE [数据库名()你也可以设参数] TO DISK = @filename WITH INIT , NOUNLOAD , NAME = N'XX数据备份', NOSKIP , STATS = 10, NOFORMAT end 存储过程要调试好无误 2、进入企业管理器中->管理->sql server代理->作业，新建作业，作业名称随便取，例如：data备份，所有者选择sa，当然你也可以选择其他用户，前提是该用户有执行作业的权限；

3.在步骤中取名－选中要备份的数据库 －－在命令中输入 exec('过程名')

4.在调度中选反复出现－－更改–选每天－－时间自己输入

5.测试完后－最后导入脚本 进入服务器

6.把SQlServer服务管理器 启用SqlServer Agent服务
p.s.一定要启动agent服务，否则调度不会执行，你可以同样利用调度实现某些表的自动更新。