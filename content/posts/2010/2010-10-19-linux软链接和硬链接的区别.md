---
title: Linux软链接和硬链接的区别
author: admin
type: post
date: 2010-10-19T03:48:10+00:00
url: /archives/6226
IM_contentdowned:
 - 1
categories:
 - 服务器
tags:
 - Linux

---
**一. 链接文件**

链接有两种方式，软链接和硬链接。

1 软链接文件

软链接又叫符号链接，这个文件包含了另一个文件的路径名。可以是任意文件或目录，可以链接不同文件系统的文件。
链接文件甚至可以链接不存在的文件，这就产生一般称之为”断链”的问题(或曰“现象”)，链接文件甚至可以循环链接自己。类似于编程语言中的递归。
用ln -s 命令可以生成一个软连接，如下:
[root@linux236 test]# ln -s source\_file softlink\_file
在对符号文件进行读或写操作的时候，系统会自动把该操作转换为对源文件的操作，但删除链接文件时，系统仅仅删除链接文件，而不删除源文件本身。
 2 硬链接文件
info ln 命令告诉您，硬链接是已存在文件的另一个名字(A “hard link” is another name for an existing file)，这多少有些令人困惑。硬连接的命令是
ln -d existfile newfile
硬链接文件有两个限制


1)、不允许给目录创建硬链接；
2)、只有在同一文件系统中的文件之间才能创建链接。
对硬链接文件进行读写和删除操作时候，结果和软链接相同。但如果我们删除硬链接文件的源文件，硬链接文件仍然存在，而且保留了愿有的内容。
这时，系统就“忘记”了它曾经是硬链接文件。而把他当成一个普通文件。

**二 .两者之间的区别**

硬连接指通过索引节点来进行的连接。在Linux的文件系统中，保存在磁盘分区中的文件不管是什么类型都给它分配一个编号，称为索引节点号(Inode Index)。
在Linux中，多个文件名指向同一索引节点是存在的。一般这种连接就是硬连接。硬连接的作用是允许一个文件拥有多个有效路径名，这样用户就可以建立硬连接到重要文件,以防止“误删”的功能。其原因如上所述，因为对应该目录的索引节点有一个以上的连接。只删除一个连接并不影响索引节点本身和其它的连接，只有当最后一个
连接被删除后，文件的数据块及目录的连接才会被释放。也就是说，文件才会被真正删除。

软链接文件有点类似于Windows的快捷方式。它实际上是特殊文件的一种。在符号连接中，文件实际上是一个文本文件，其中包含的有另一文件的位置信息。

**连接计数count**：
前面我们介绍了，文件的链接计数域表明本系统中共有几个文件目录项的inode和本文件相同，也就是本文件共有几个硬链接。如上面的例子中AAA和AAAhard文件的count值都是2。
那么对于目录，其count域的含义是什么呢？目录的count同样表示共有多少个目录项指向此目录，不过要详细说明必须进一步解释VFS文件系统的结构，为简单起见，只要这样理解就行了：(count-2)等于本目录包含的直接子目录数(就是只包括儿子，不包括孙子)。
例如：如果一个目录/ln的count域为5，那么/ln目录一定包含3个子目录。

**三 .总结**
软链接是另一个文件，作用可以理解为一个指针，作用在这个文件上的操作除了删除都直接转向实际指向文件，由于是一个真实的文件所以占用磁盘空间硬链接可以认为不是一个文件，它只是实际文件的一个别名，它的作用是防止真实文件被误操作，给一个文件建立硬链接后，他们互为别名，删除其中任意一个，只会删除该别名，实际文件并不会被删除。由于只是别名没有任何其他信息，所以并不占用原始文件大小的磁盘空间。

octapult 写到:
这边有关 inode 的部份似乎讲反了。
hard link 並沒有另外建立一个 inode，而是增加一个 directory entry，內容为原始档案的 inode number、這个 hard link 的档案名稱和其他相关资訊，所以 hard link 的 inode number 跟原始档案的 inode number 是一样的。在建立 soft link 的時候才会建立一个新的 inode 指到原始档案的 inode，所以 soft link 的 inode number 跟原始档案的 inode number 不一样。這也是为什么 hard link 只能指向同一个档案系統里面的档案，因为每个档案系統都有它自己一系列的 inode，兩个不同的档案系統可能有相同的 inode number。而 soft link 具有完整的 pathname，所以他可以跨越不同的档案系統。