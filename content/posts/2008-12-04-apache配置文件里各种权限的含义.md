---
title: Apacheé…ç½®æ–‡ä»¶é‡Œå„ç§æƒé™çš„å«ä¹‰
author: admin
type: post
date: 2008-12-04T05:04:00+00:00
excerpt: |
 /etc/apache/httpd.conf :

 ServerRoot "/usr"
 #å› ä¸ºå®‰è£…åˆ°/usrä¸‹ï¼Œæ‰€ä»¥ServerRootæ˜¯/usrã€‚åœ¨ä»¥ä¸‹é…ç½®ä¸­ï¼Œä»¥ç›¸å¯¹è·¯å¾„å†™çš„å°±æ˜¯å¯¹äºç›¸å¯¹/usr
 PidFile /var/run/httpd.pid
 #httpdå¯åŠ¨æ—¶çš„pidå­˜æ”¾ä½ç½®,ç”¨äºstart/stop apache
 Timeout 300
 #è¿æ¥è¶…æ—¶æ—¶é—´
 KeepAlive On
 #å…è®¸æŒç»­è¿æ¥ï¼Œä¸€ä¸ªè¿æ¥å¤šä¸ªè¯·æ±‚.
 MaxKeepAliveRequests 200
 #æŒç»­è¿æ¥ä¸­æœ€å¤§è¿æ¥æ•°ï¼Œæ¨èå¤§ä¸€äº›è·å¾—æœ€ä½³æ€§èƒ½
url: /archives/673
IM_contentdowned:
 - 1
categories:
 - æœåŠ¡å™¨
tags:
 - apache

---
/etc/apache/httpd.conf :

ServerRoot â€œ/usrâ€

 #å› ä¸ºå®‰è£…åˆ°/usrä¸‹ï¼Œæ‰€ä»¥ServerRootæ˜¯/usrã€‚åœ¨ä»¥ä¸‹é…ç½®ä¸­ï¼Œä»¥ç›¸å¯¹è·¯å¾„å†™çš„å°±æ˜¯å¯¹äºç›¸å¯¹/usr

PidFile /var/run/httpd.pid

 #httpdå¯åŠ¨æ—¶çš„pidå­˜æ”¾ä½ç½®,ç”¨äºstart/stop apache

Timeout 300

 #è¿æ¥è¶…æ—¶æ—¶é—´

KeepAlive On

 #å…è®¸æŒç»­è¿æ¥ï¼Œä¸€ä¸ªè¿æ¥å¤šä¸ªè¯·æ±‚.

MaxKeepAliveRequests 200

 #æŒç»­è¿æ¥ä¸­æœ€å¤§è¿æ¥æ•°ï¼Œæ¨èå¤§ä¸€äº›è·å¾—æœ€ä½³æ€§èƒ½

KeepAliveTimeout 15

 #Client åœ¨15ç§’å†…æ²¡æœ‰ä¸‹æ¬¡è¯·æ±‚åˆ™æ–­çº¿

MinSpareServersÂ Â Â Â Â  5

MaxSpareServersÂ Â Â Â Â  10

 httpdæœåŠ¡è¿›ç¨‹çš„æ•°é‡ï¼Œps aux å¯ä»¥çœ‹åˆ°

MaxClientsÂ Â Â Â Â Â Â Â  150

 æœ€å¤§è¿æ¥äººæ•°

Listen 80

 #ç›‘å¬ç«¯å£

#ExtendedStatus On

 #ä½¿ç”¨/server-statusæŸ¥è¯¢æœåŠ¡å™¨çŠ¶æ€æ—¶ç»™äºˆå®Œå…¨ä¿¡æ¯(ON)æˆ–åŸºæœ¬ä¿¡æ¯(OFF) é»˜è®¤ä¸ºOFF

User apache

Group apache

 #httpdè¿›ç¨‹çš„user,group

ServerAdmin BlueSilence.xin@gmail.com

 #adminçš„E-mail

ServerName 127.0.0.1

 #æœåŠ¡å™¨åç§°ï¼Œéœ€è¦æ˜¯åˆæ³•çš„DNS NAME æˆ–è€…è®¾ç½®æˆIPDocumentRoot â€œ/srv/www/htdocsâ€
#ä¸»é¡µå­˜æ”¾ç›®å½•
UserDir public_html
#æ¯ä¸ªç”¨æˆ·çš„ä¸»é¡µç›®å½• (ä¾‹å¦‚:/home/blue/public_html)
DirectoryIndex index.php index.html index.html.var
#å½“è¾“å…¥http://localhost å°±ä¼šåœ¨ä¸»é¡µæ ¹ç›®å½•ä¸‹æœç´¢ä»¥ä¸Šå‡ ä¸ªæ–‡ä»¶ååšä¸ºé¦–é¡µæ˜¾ç¤º
HostnameLookups Off
#è®°å½•logæ—¶ï¼ŒClientä»¥ä¸»æœºå(On)æˆ–ä»¥IP(Off)è®°å½•ï¼Œä»¥IPè®°å½•æ›´å¿«äº›.
ErrorLog /var/log/apache/error_log
#é”™è¯¯æ—¥å¿—ä½ç½®
LogLevel warn
#æ—¥å¿—è®°å½•ç­‰çº§,ç”±ä¿¡æ¯å¤š->å°‘è®°å½•ç­‰çº§ï¼šdebug, info, notice, warn, error, crit,alert,emerg
CustomLog /var/log/apache/access_log common
#è®¿é—®æ—¥å¿—ä½ç½®
ServerTokens Prod
#å½“clientè®¿é—®åˆ°ä¸å­˜åœ¨çš„ç½‘é¡µæ—¶æä¾›ä¿¡æ¯çš„å¤šå°‘ã€‚å°‘ç‚¹å¥½äº› ğŸ™‚
#ç”±å¤šâ€“>å°‘ :Full | OS | Minor | Minimal | Major | Prod
LanguagePriority zh-CN en ca cs da de â€¦â€¦â€¦.
#è¯­è¨€ä¼˜å…ˆçº§
ErrorDocument 404 /missing.html
#é”™è¯¯ç½‘é¡µå¤„ç†ï¼Œå½“å‡ºç°404(æ‰¾ä¸åˆ°è¯¥é¡µ)åˆ™ä¼šæ˜¾ç¤º/missing.html

ç›®å½•è®¾å®š:
è®¾å®šæ ¹ç›®å½•å±æ€§ï¼š

Â Â Â  Options FollowSymLinks
Â Â Â  AllowOverride None

Options å±æ€§:
IndexesÂ Â Â Â Â Â Â Â  å½“è¯¥ç›®å½•ä¸‹æ²¡æœ‰index.*æ—¶åˆ™ä»¥ftp-styleåˆ—å‡ºè¯¥ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶
IncludesÂ Â Â Â Â Â Â  Allow server-wide includes
FollowSymLinks å½“è¯¥ç›®å½•ä¸‹è½¯è¿æ¥çš„æ–‡ä»¶/ç›®å½•é“¾æ¥åˆ°å¤–éƒ¨ç›®å½•æ—¶ï¼Œä»ç„¶å¯ä»¥æ­£å¸¸æ˜¾ç¤ºã€‚
MultiViewsÂ Â Â Â  ç”±ä¸€ä¸ª*.varç®¡ç†åŒä¸€ç½‘é¡µçš„å¤šç§è¯­è¨€ç‰ˆæœ¬,å¦‚apacheé»˜è®¤ä¸»é¡µå¤šç§è¯­è¨€çš„index.html
ExecCGIÂ Â Â Â Â Â Â Â  å…è®¸æ‰§è¡ŒCGIç¨‹åº
ALLÂ Â Â Â Â Â Â Â Â Â Â Â  å¼€å¯é™¤MultiViewsä¹‹å¤–çš„å±æ€§
NoneÂ Â Â Â Â Â Â Â Â Â Â  ç¦æ­¢æ‰€æœ‰å±æ€§

AllowOverride æ˜¯å¦å…è®¸ä½¿ç”¨.htaccessè¦†ç›–æŸäº›è®¾å®š(All None FileInfo AuthConfig Limit)

è®¾å®š/srv/www/htdocs/ ç›®å½•(æ ¹ç›®å½•)å±æ€§:

Options Indexes FollowSymLinks
AllowOverride None
Order allow,deny
Â Â Â  Allow from all

Order allow,deny : æ§åˆ¶è®¿é—®æƒé™
Order deny,allow
deny from test.org æ‹’ç»test.orgè®¿é—®
deny from 192.168.0.100 æ‹’ç»192.168.0.100è®¿é—®
allow from 192.168.0.1 å…è®¸192.168.0.1 è®¿é—®

Alias /icons/ â€œ/srv/www/icons/â€
è¯­æ³•ï¼š Alias fakename realname
è®¾ç½®ç›®å½•çš„åˆ«åï¼Œè¿™æ ·å½“è¾“å…¥http://localhost/icons/ å°±å¯ä»¥è®¿é—®åˆ°/srv/www/icons/
æ³¨æ„iconsç»“å°¾çš„â€/â€ åº”åœ¨fakename realname æˆå¯¹å‡ºç°,è¦ä¹ˆå…¨æœ‰,è¦ä¹ˆå…¨æ²¡æœ‰.
æœ‰â€/â€æ—¶éœ€è¦è¾“å…¥http://localhost/icons/ æ‰å¯ä»¥æ­£å¸¸è®¿é—®

ScriptAlias /cgi-bin/ â€œ/srv/www/cgi-bin/â€
è®¾ç½®å¯æ‰§è¡Œç¨‹åºåˆ«å,ä¸Aliasç±»ä¼¼ã€‚
å½“Clientè¯·æ±‚Alias realnameæ—¶ï¼Œserverç›´æ¥ä»¥documentå½¢å¼ä¼ é€Client
è€ŒScroptAliasåˆ™æ˜¯serveræ‰§è¡Œrealnameçš„scriptç¨‹åºåå°†ç»“æœä¼ é€ç»™Client

æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œä¿¡æ¯:
é€šè¿‡http://localhost/server-status è®¿é—®

Â Â Â  SetHandler server-status
Â Â Â  Order deny,allow
Â Â Â  Deny from all
Â Â Â  Allow from 127.0.0.1

é€šè¿‡http://localhost/server-info è®¿é—®

Â Â Â  SetHandler server-info
Â Â Â  Order deny,allow
Â Â Â  Deny from all
Â Â Â  Allow from 127.0.0.1

.cgi .plç¨‹åºå¯æ‰§è¡Œçš„ä¸‰ç§æ–¹æ³•ï¼š
1ï¼šä½¿ç”¨ScriptAliasï¼Œhttpd.confä¸­åŠ å…¥ï¼š
ScriptAlias /my-cgi/ â€œ/srv/www/cgiâ€
è¿™æ ·å°±å¯ä»¥ä»¥http://localhost/my-cgi/xxx.cgi xxx.plæ‰§è¡Œ/srv/www/cgi/ä¸‹çš„.cgi,.plç¨‹åºäº†ã€‚

2: ä½¿ç”¨sethandler cgi-scriptsï¼Œhttpd.confä¸­åŠ å…¥ï¼š
Alias /my-cgi/ â€œ/srv/www/cgiâ€

Â Â  Options ExecCGI
Â Â  Sethandler cgi-script

3:ä½¿ç”¨Optionsçš„ExecCGIå±æ€§ :
å°†httpd.confä¸­çš„AddHandler cgi-script .cgi .pl æ³¨é‡Šæ‹¿æ‰ï¼ŒåŠ ä¸Š.pl
ç»™äºˆ/srv/www/cgi/ æ‰§è¡ŒCGIæƒé™:
Alias /my-cgi/ â€œ/srv/www/cgiâ€

Â Â  Options ExecCGI
Â Â  Allowoverride none
Â Â  Order allow,deny
Â Â  allow from all

è®¤è¯ç½‘é¡µï¼š

Â Â  Options FollowSymlinks Indexes ExecCGI
Â Â  AllowOverride None
Â Â  Order Allow,Deny
Â Â  Allow From all
Â Â  AuthName â€œprivate directory â€
Â Â  AuthType Basic
Â Â  AuthUserFile /etc/apace/apache.passwd
Â Â  Require valid-user

AuthNmae :Â Â Â Â Â  è®¤è¯çª—å£ä¸Šçš„æ ‡é¢˜
AuthType :Â Â Â Â Â  è®¤è¯ç±»å‹,apacheæœ‰å‡ ç§è®¤è¯æ–¹å¼ï¼ŒBasicä¸ºæœ€åŸºæœ¬çš„ã€‚
AuthUserFIle : è®¤è¯å¯†ç å­˜æ”¾ä½ç½®
Require : è®¤è¯æ¡£æ¡ˆä¸­å…è®¸ä½¿ç”¨çš„ç”¨æˆ·
valid-user :Â Â  è®¤è¯æ¡£æ¡ˆä¸­æ‰€æœ‰çš„ç”¨æˆ·éƒ½å¯ä»¥ä½¿ç”¨é€šè¿‡è®¤è¯è¿›å…¥è¯¥ç›®å½•
å¦‚åªæƒ³å…è®¸æŸä¸ªç”¨æˆ·åˆ™ä½¿ç”¨ Require user username1 username2 å»ºç«‹è®¤è¯å¯†ç æ–‡ä»¶ï¼š
#cd /etc/apache/
#htpasswd -c apache.passwd blue
New password:
Re-type new password:
Adding password for user blue
#
-c : å¦‚æœæ²¡æœ‰apache.passwdåˆ™åˆ›å»ºå®ƒå¢åŠ è®¤è¯ç”¨æˆ·ï¼š
#htpasswd apache.passwd silence
â€¦.
#apachectl restart
#firefox http://localhost/my-cgi/
è¦æ±‚å¯†ç æ‰å¯ä»¥è¿›å…¥å–½ ğŸ™‚

.htaccess å’Œ allowoverride :.htaccess : å–ä»£httpd.confä¸­å¯¹.htaccessæ‰€åœ¨ç›®å½•çš„è®¾å®šã€‚
AllowOverride :å…è®¸è¦†ç›–è®¾å®šçš„ç±»å‹(All None FileInfo AuthConfig Limit)

è®¾å®šæ¯ä¸ªç”¨æˆ·éƒ½å¯ä»¥å»ºç«‹è‡ªå·±çš„è®¤è¯ç½‘é¡µï¼š


1.ç¡®å®šhttpd.confä¸­AccessFileName .htaccess æ²¡æœ‰è¢«æ³¨é‡Šæ‰
2.ç¼–è¾‘httpd.confåŠ å…¥AllowOverride AuthConfig,å…è®¸æ¯ä¸ªç”¨æˆ·é€šè¿‡.htaccesså»ºç«‹è‡ªå·±çš„è®¤è¯ç½‘é¡µ

Â Â  AllowOverride AuthConfig
Â Â Â  Order Allow,Deny
Â Â Â Â  Allow from all

3.ç”¨æˆ·å»ºç«‹è®¤è¯ç›®å½•ï¼Œç¼–å†™.htaccess :
mkdir privatecd private/ echo â€ private page â€ >test.html vi .htaccess
AuthName â€œprivateâ€
AuthType basic
AuthUserFIle /home/blue/blue.passwd
Require valid-user
å»ºç«‹å¯†ç æ–‡ä»¶ï¼šhtpasswd -c blue.passwd blue
â€¦â€¦
firefox http://localhost/~blue/private/test.html